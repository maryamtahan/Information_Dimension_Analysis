clc; clear; close all;

a = 1/3;
K = 14;
Ns = 20000;

X = zeros(Ns,1);

for k = 0:K
    xi = rand(Ns,1);
    xi(xi>=0.5)=1;
    xi(xi<0.5)=-1;
    X = X + (a^k)*xi;
end

Xs = sort(X);
cdfx = (1:length(Xs))'/length(Xs);

figure;
stairs(Xs,cdfx,'k','LineWidth',1);
grid on;
xlabel('x');
ylabel('CDF');
title('Figure 2: Bernoulli Convolution CDF (a = 1/3)');
axis([min(Xs) max(Xs) 0 1]);

